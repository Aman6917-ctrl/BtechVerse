<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interview Preparation - BTechVerse</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="assets/style.css" rel="stylesheet">
    <meta name="env-FIREBASE_API_KEY" content="AIzaSyAfXDF2MOkPXudbI10oKeOYugDz3GwREa4">
    <meta name="env-FIREBASE_PROJECT_ID" content="btechverse-c469b">
    <meta name="env-FIREBASE_APP_ID" content="145554824271:web:345ce29491d664e1d29e3a">
</head>
<body class="min-h-screen overflow-x-hidden">
    <!-- Animated Background -->
    <div class="fixed inset-0 bg-gradient-to-br from-slate-800 via-indigo-800 to-purple-800">
        <div class="absolute inset-0 bg-black opacity-40"></div>
        <div class="particles-container absolute inset-0">
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
            <div class="particle"></div>
        </div>
    </div>
    <!-- Navigation -->
    <nav class="relative z-50 glass-nav backdrop-blur-xl bg-white/10 border-b border-white/20 sticky top-0">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-20 items-center">
                <div class="flex items-center">
                    <a href="index.html" class="flex-shrink-0">
                        <h1 class="text-3xl font-black text-white logo-nav">BTechVerse</h1>
                    </a>
                    <div class="ml-8">
                        <span class="text-lg font-semibold text-white/80">Interview Preparation</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="resources.html" class="text-white/80 hover:text-white transition-colors duration-300">All Resources</a>
                    <div id="adminPanel" class="hidden">
                        <a href="upload.html" class="bg-green-500/80 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition duration-300 backdrop-blur-sm"><i class="fas fa-upload mr-2"></i>Upload</a>
                    </div>
                    <div id="userSection" class="flex items-center space-x-4">
                        <span id="userEmail" class="text-white/80 font-medium"></span>
                        <button id="logoutBtn" class="bg-red-500/80 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition duration-300 backdrop-blur-sm"><i class="fas fa-sign-out-alt mr-2"></i>Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <section class="relative z-10 py-20">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="glass-card p-8 rounded-3xl backdrop-blur-xl bg-white/10 border border-white/20 shadow-2xl">
                <i class="fas fa-briefcase text-7xl mb-6 text-white"></i>
                <h1 class="text-5xl font-black text-white mb-6">Interview Preparation Hub</h1>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">Everything you need to ace your technical interviews and land your dream job</p>
            </div>
        </div>
    </section>

    <!-- Quick Stats -->
    <section class="relative z-10 py-12">
        <div class="max-w-7xl mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-6 text-center">
                <div class="glass-card p-6 rounded-2xl" data-aos="fade-up" data-aos-delay="100">
                    <i class="fas fa-code text-4xl text-indigo-300 mb-3"></i>
                    <h3 class="text-2xl font-bold text-white">DSA</h3>
                    <p class="text-gray-300">Data Structures & Algorithms</p>
                </div>
                <div class="glass-card p-6 rounded-2xl" data-aos="fade-up" data-aos-delay="200">
                    <i class="fas fa-database text-4xl text-green-300 mb-3"></i>
                    <h3 class="text-2xl font-bold text-white">DBMS</h3>
                    <p class="text-gray-300">Database Management</p>
                </div>
                <div class="glass-card p-6 rounded-2xl" data-aos="fade-up" data-aos-delay="300">
                    <i class="fas fa-users text-4xl text-purple-300 mb-3"></i>
                    <h3 class="text-2xl font-bold text-white">HR</h3>
                    <p class="text-gray-300">Human Resources</p>
                </div>
                <div class="glass-card p-6 rounded-2xl" data-aos="fade-up" data-aos-delay="400">
                    <i class="fas fa-file-alt text-4xl text-pink-300 mb-3"></i>
                    <h3 class="text-2xl font-bold text-white">Resume</h3>
                    <p class="text-gray-300">Resume & Cover Letters</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="relative z-10 py-16">
        <div class="max-w-7xl mx-auto px-4">
            <!-- Search Bar -->
            <div class="mb-12">
                <div class="max-w-md mx-auto">
                    <div class="relative">
                        <input type="text" id="searchInput" placeholder="Search interview materials..." 
                               class="w-full px-6 py-4 pl-14 bg-white/10 border border-white/30 rounded-2xl text-white placeholder-gray-400 focus:ring-2 focus:ring-indigo-400 focus:border-transparent transition-all duration-300 backdrop-blur-sm">
                        <i class="fas fa-search absolute left-5 top-1/2 transform -translate-y-1/2 text-gray-400 text-lg"></i>
                    </div>
                </div>
            </div>

            <!-- Categories -->
            <div class="grid lg:grid-cols-2 gap-12">
                <!-- Technical Preparation -->
                <div class="space-y-8">
                    <h2 class="text-3xl font-bold text-white mb-6" data-aos="fade-right">
                        <i class="fas fa-laptop-code text-indigo-300 mr-3"></i>Technical Preparation
                    </h2>

                    <!-- DSA Section -->
                    <div class="glass-card rounded-2xl p-6" data-aos="fade-up">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-code text-2xl text-blue-600 mr-3"></i>
                            <h3 class="text-xl font-semibold text-white">Data Structures & Algorithms</h3>
                        </div>
                        <div id="dsaResources" class="space-y-3">
                            <!-- DSA resources will be loaded here -->
                        </div>
                    </div>

                    <!-- DBMS Section -->
                    <div class="glass-card rounded-2xl p-6" data-aos="fade-up" data-aos-delay="100">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-database text-2xl text-green-600 mr-3"></i>
                            <h3 class="text-xl font-semibold text-white">Database Management (DBMS)</h3>
                        </div>
                        <div id="dbmsResources" class="space-y-3">
                            <!-- DBMS resources will be loaded here -->
                        </div>
                    </div>

                    <!-- Operating Systems Section -->
                    <div class="glass-card rounded-2xl p-6" data-aos="fade-up" data-aos-delay="200">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-server text-2xl text-indigo-600 mr-3"></i>
                            <h3 class="text-xl font-semibold text-white">Operating Systems (OS)</h3>
                        </div>
                        <div id="osResources" class="space-y-3">
                            <!-- OS resources will be loaded here -->
                        </div>
                    </div>

                    <!-- Computer Networks Section -->
                    <div class="glass-card rounded-2xl p-6" data-aos="fade-up" data-aos-delay="300">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-network-wired text-2xl text-teal-600 mr-3"></i>
                            <h3 class="text-xl font-semibold text-white">Computer Networks (CN)</h3>
                        </div>
                        <div id="cnResources" class="space-y-3">
                            <!-- CN resources will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Soft Skills & Career -->
                <div class="space-y-8">
                    <h2 class="text-3xl font-bold text-white mb-6" data-aos="fade-left">
                        <i class="fas fa-users text-indigo-300 mr-3"></i>Soft Skills & Career
                    </h2>

                    <!-- HR Questions Section -->
                    <div class="glass-card rounded-2xl p-6" data-aos="fade-up">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-comments text-2xl text-purple-600 mr-3"></i>
                            <h3 class="text-xl font-semibold text-white">HR Interview Questions</h3>
                        </div>
                        <div id="hrResources" class="space-y-3">
                            <!-- HR resources will be loaded here -->
                        </div>
                    </div>

                    <!-- Resume & Cover Letter Section -->
                    <div class="glass-card rounded-2xl p-6" data-aos="fade-up" data-aos-delay="100">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-file-alt text-2xl text-orange-600 mr-3"></i>
                            <h3 class="text-xl font-semibold text-white">Resume & Cover Letter Tips</h3>
                        </div>
                        <div id="resumeResources" class="space-y-3">
                            <!-- Resume resources will be loaded here -->
                        </div>
                    </div>

                    <!-- Aptitude Section -->
                    <div class="glass-card rounded-2xl p-6" data-aos="fade-up" data-aos-delay="200">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-calculator text-2xl text-red-600 mr-3"></i>
                            <h3 class="text-xl font-semibold text-white">Aptitude & Reasoning</h3>
                        </div>
                        <div id="aptitudeResources" class="space-y-3">
                            <!-- Aptitude resources will be loaded here -->
                        </div>
                    </div>

                    <!-- Placement Roadmap Section -->
                    <div class="glass-card rounded-2xl p-6" data-aos="fade-up" data-aos-delay="300">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-road text-2xl text-pink-600 mr-3"></i>
                            <h3 class="text-xl font-semibold text-white">Placement Roadmap</h3>
                        </div>
                        <div id="roadmapResources" class="space-y-3">
                            <!-- Roadmap resources will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loadingState" class="text-center py-12">
                <i class="fas fa-spinner fa-spin text-4xl text-purple-600 mb-4"></i>
                <p class="text-gray-600">Loading interview preparation materials...</p>
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="hidden text-center py-12">
                <i class="fas fa-briefcase text-6xl text-gray-400 mb-4"></i>
                <h3 class="text-xl font-semibold text-gray-700 mb-2">No resources found</h3>
                <p class="text-gray-500">Interview preparation materials will be available soon.</p>
            </div>
        </div>
    </section>

    <!-- Tips Section -->
    <section class="relative z-10 py-16">
        <div class="max-w-7xl mx-auto px-4">
            <h2 class="text-3xl font-bold text-center text-white mb-12" data-aos="fade-up">Interview Success Tips</h2>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="glass-card text-center p-6 rounded-2xl" data-aos="fade-up" data-aos-delay="100">
                    <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-white/20">
                        <i class="fas fa-clock text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-white mb-3">Practice Daily</h3>
                    <p class="text-gray-300">Consistent practice of coding problems and technical concepts</p>
                </div>
                <div class="glass-card text-center p-6 rounded-2xl" data-aos="fade-up" data-aos-delay="200">
                    <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-white/20">
                        <i class="fas fa-lightbulb text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-white mb-3">Understand Concepts</h3>
                    <p class="text-gray-300">Focus on understanding rather than memorizing solutions</p>
                </div>
                <div class="glass-card text-center p-6 rounded-2xl" data-aos="fade-up" data-aos-delay="300">
                    <div class="w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 bg-white/20">
                        <i class="fas fa-users text-2xl text-white"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-white mb-3">Mock Interviews</h3>
                    <p class="text-gray-300">Practice with peers and get feedback on your performance</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="relative z-10 bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 text-white py-16">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="mb-8">
                <h3 class="text-4xl font-black text-white mb-4">BTechVerse</h3>
                <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">Empowering BTech students with free educational resources and cutting-edge learning tools</p>
            </div>
            <div class="pt-8 border-t border-gray-700">
                <p class="text-gray-400">&copy; 2024 BTechVerse. All rights reserved. Made with ❤️ for students.</p>
            </div>
        </div>
    </footer>

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1481.0.min.js"></script>
    <script type="module" src="js/firebase.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/display.js?v=2"></script>
    <script type="module" src="js/s3-service.js"></script>
    <script type="module" src="js/chatbot.js"></script>
    <script src="js/utils.js"></script>
    
    <script>
        let allInterviewResources = [];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthState();
            loadInterviewResources();
            setupSearchFilter();
            initAnimations();
        });

        // GSAP Animations
        gsap.registerPlugin(ScrollTrigger);

        function initAnimations() {
            gsap.set('.logo-nav', { opacity: 0, x: -50 });
            gsap.set('.glass-card', { opacity: 0, y: 50, scale: 0.9 });
            gsap.set('.particle', { opacity: 0, scale: 0 });

            const tl = gsap.timeline();
            tl.to('.logo-nav', { opacity: 1, x: 0, duration: 1, ease: 'power2.out' })
              .to('.particle', { opacity: 1, scale: 1, duration: 1, stagger: 0.1, ease: 'power2.out' }, '-=0.6')
              .to('.glass-card', { opacity: 1, y: 0, scale: 1, duration: 1, ease: 'power2.out' }, '-=0.4');

            gsap.to('.particles-container', { yPercent: -40, ease: 'none', scrollTrigger: { trigger: 'body', start: 'top bottom', end: 'bottom top', scrub: true } });
        }

        async function loadInterviewResources() {
            try {
                showLoading();
                
                if (window.loadInterviewResources) {
                    allInterviewResources = await window.loadInterviewResources();
                    displayInterviewResources(allInterviewResources);
                } else {
                    hideLoading();
                    showEmptyState();
                }
            } catch (error) {
                console.error('Error loading interview resources:', error);
                hideLoading();
                showToast('Error loading resources', 'error');
            }
        }

        function displayInterviewResources(resources) {
            if (resources.length === 0) {
                hideLoading();
                showEmptyState();
                return;
            }

            hideLoading();
            hideEmptyState();

            // Group resources by subject
            const groupedResources = resources.reduce((acc, resource) => {
                const subject = resource.subject || 'General';
                if (!acc[subject]) acc[subject] = [];
                acc[subject].push(resource);
                return acc;
            }, {});

            // Display resources in each section
            displayResourcesInSection('dsaResources', groupedResources['DSA'] || []);
            displayResourcesInSection('dbmsResources', groupedResources['DBMS'] || []);
            displayResourcesInSection('osResources', groupedResources['OS'] || []);
            displayResourcesInSection('cnResources', groupedResources['CN'] || []);
            displayResourcesInSection('hrResources', groupedResources['HR'] || []);
            displayResourcesInSection('resumeResources', groupedResources['Resume'] || []);
            displayResourcesInSection('aptitudeResources', groupedResources['Aptitude'] || []);
            displayResourcesInSection('roadmapResources', groupedResources['Roadmap'] || []);
        }

        function displayResourcesInSection(sectionId, resources) {
            const section = document.getElementById(sectionId);
            
            if (resources.length === 0) {
                section.innerHTML = '<p class="text-gray-500 italic">No resources available yet</p>';
                return;
            }

            section.innerHTML = resources.map(resource => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-200">
                    <div class="flex-1">
                        <h4 class="font-medium text-gray-900">${resource.title}</h4>
                        ${resource.creditName ? `<p class="text-sm text-gray-500 italic">Credit: ${resource.creditName}</p>` : ''}
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="viewResource('${resource.fileURL}', '${resource.title}', '${resource.subject || 'Interview Prep'}', '${resource.branch || 'General'}')" 
                                class="text-indigo-600 hover:text-indigo-800 transition duration-200">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button onclick="downloadResource('${resource.fileURL}', '${resource.title}')" 
                                class="text-green-600 hover:text-green-800 transition duration-200">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function setupSearchFilter() {
            document.getElementById('searchInput').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                const filteredResources = allInterviewResources.filter(resource => {
                    return resource.title.toLowerCase().includes(searchTerm) ||
                           (resource.subject && resource.subject.toLowerCase().includes(searchTerm));
                });

                displayInterviewResources(filteredResources);
            });
        }

        async function downloadResource(fileURL, title) {
            try {
                showToast('Preparing download...', 'info');
                await window.downloadFileFromS3(fileURL, title);
                showToast('Download started', 'success');
            } catch (error) {
                console.error('Download failed:', error);
                showToast('Download failed. Please try again.', 'error');
            }
        }

        async function viewResource(fileURL, resourceTitle, resourceSubject, resourceBranch) {
            try {
                showToast('Opening file...', 'info');
                await window.viewFileFromS3(fileURL);
                showToast('File opened in new tab', 'success');
                
                // Set chatbot context for the opened note
                if (window.BTechVerseChatbot) {
                    window.BTechVerseChatbot.setContext(resourceTitle, resourceSubject, resourceBranch);
                }
            } catch (error) {
                console.error('Failed to open file:', error);
                showToast('Failed to open file. Please try again.', 'error');
            }
        }

        function showLoading() {
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('emptyState').classList.add('hidden');
            document.querySelector('.grid.lg\\:grid-cols-2').classList.add('hidden');
        }

        function hideLoading() {
            document.getElementById('loadingState').classList.add('hidden');
            document.querySelector('.grid.lg\\:grid-cols-2').classList.remove('hidden');
        }

        function showEmptyState() {
            document.getElementById('emptyState').classList.remove('hidden');
            document.querySelector('.grid.lg\\:grid-cols-2').classList.add('hidden');
        }

        function hideEmptyState() {
            document.getElementById('emptyState').classList.add('hidden');
        }

        // Initialize AOS
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true
        });
    </script>
</body>
</html>
